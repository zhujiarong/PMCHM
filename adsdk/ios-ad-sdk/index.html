<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../favicon.ico">
        

        <title>iOS Ad SDK - Domob Developer Guides</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Domob Developer Guides</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Ad SDK <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li class="active">
                                <a href=".">iOS Ad SDK</a>
                            </li>
                        
                            <li >
                                <a href="../android-ad-sdk">Android Ad SDK</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Native Ad SDK <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../nativesdk/native-default">Native Ad Information</a>
                            </li>
                        
                            <li >
                                <a href="../../nativesdk/ios-native-ad-sdk">iOS Native Ad SDK</a>
                            </li>
                        
                            <li >
                                <a href="../../nativesdk/android-native-ad-sdk">Android Native Ad SDK</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">DBox SDK <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../dboxsdk/about-dbox-sdk">About DBox</a>
                            </li>
                        
                            <li >
                                <a href="../../dboxsdk/ios-dbox-sdk">iOS DBox SDK</a>
                            </li>
                        
                            <li >
                                <a href="../../dboxsdk/android-dbox-sdk">Android DBox SDK</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">如何... <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../../howto/how-to-get-ids">如何获得PublisherId和PlacementID</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                </ul>
            

            
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                
                <li>
                    <a href="https://github.com/Domob-SDK">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
            
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#domob-ios-ad-sdk">Domob iOS Ad SDK</a></li>
        
            <li><a href="#_1">必要条件</a></li>
        
            <li><a href="#sdk">获取SDK</a></li>
        
            <li><a href="#sdk_1">加入SDK</a></li>
        
            <li><a href="#_2">获取地理位置方法的说明</a></li>
        
            <li><a href="#banner-ad">使用横幅广告（Banner Ad）</a></li>
        
            <li><a href="#_4">横幅广告的尺寸</a></li>
        
            <li><a href="#interstitial-ad">使用插屏广告（Interstitial Ad）</a></li>
        
            <li><a href="#feeds-ad">使用信息流广告（Feeds Ad）</a></li>
        
            <li><a href="#splash-ad">使用开屏广告（Splash Ad）</a></li>
        
            <li><a href="#_8">获取示例</a></li>
        
            <li><a href="#_9">获得帮助</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="domob-ios-ad-sdk">Domob iOS Ad SDK</h1>
<h2 id="_1">必要条件</h2>
<ul>
<li><code>Xcode 6</code>或更高版本</li>
<li><code>iOS 4.3</code>或更高版本</li>
</ul>
<h2 id="sdk">获取SDK</h2>
<p>请前往多盟官网的<a href="http://www.domob.cn/developers/SDKdownload.htm">SDK下载页面</a>下载最新的SDK发行包。</p>
<p><strong>注意：该页在登陆后才能访问。</strong></p>
<h2 id="sdk_1">加入SDK</h2>
<p>将SDK的发行包（一个zip文件）解压缩。其中需要添加到项目中的文件包括一个静态库文件（.a），若干个Objective-C头文件（.h）以及一个Bundle文件（.bundle）。</p>
<ol>
<li>
<p>将上述文件，添加到您的项目中。建议直接将<code>DomobAdSDK</code>文件夹添加到项目中。包含的内容，如下图：<center><img alt="" src="../../assets/adsdk/ios-sdk-files.png" /></center></p>
</li>
<li>
<p>若要SDK正常工作，需要向项目中添加下面这些Framework，如下图：<center><img alt="" src="../../assets/adsdk/ios-adk-frameworks.png" /></center></p>
</li>
<li>
<p>另外还需要在项目的 <code>Build Settings</code> &gt; <code>Linking</code> &gt; <code>Other Linker Flags</code> 中添加 <code>–ObjC</code>， 如图:<center><img alt="" src="../../assets/adsdk/ios-adk-settings.png" /></center></p>
</li>
</ol>
<p>这样，就可以开始使用多盟SDK了。</p>
<h2 id="_2">获取地理位置方法的说明</h2>
<p>为了能够在<code>iOS 8及以上</code>系统中能够正确获取地理位置信息，开发者需要在项目的plist文件中配置苹果新添加的key（如下表），来支持App获取地理位置信息。</p>
<table>
<thead>
<tr>
<th align="left">Key</th>
<th>Summary</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">NSLocationAlwaysUsageDescription</td>
<td>Specifies the reason for accessing the user’s location information. See <a href="https://developer.apple.com/library/mac/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW18">NSLocationAlwaysUsageDescription</a> for details.</td>
</tr>
<tr>
<td align="left">NSLocationWhenInUseUsageDescription</td>
<td>Specifies the reason for accessing the user’s location information. See <a href="https://developer.apple.com/library/mac/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW26">NSLocationWhenInUseUsageDescription</a> for details.</td>
</tr>
</tbody>
</table>
<p><code>说明：由于部分广告会定向投递到特定的地域，因此SDK需要获取地理位置以支持广告的定向投放。在无法获取相关地理位置信息时，将不展示广告信息。</code></p>
<h2 id="banner-ad">使用横幅广告（Banner Ad）</h2>
<p>若要在应用中添加一个横幅广告（Banner Ad），只需要简单的几步：</p>
<ol>
<li>导入<code>DMAdView.h</code>头文件。</li>
<li>声明一个<code>DMAdView</code>的实例。</li>
<li>使您的UIViewController实现<code>DMAdViewDelegate</code>。</li>
<li>在您的UIViewController的m文件中，使用您从多盟官网获得的Publisher ID和 Placement ID以及您期望的广告尺寸，来初始化DMAdView。</li>
<li>设置DMAdView的委派。</li>
<li>设置DMAdView的<code>rootViewController</code>。</li>
<li>设置DMAdView的<code>frame</code>，把DMAdView放置在您希望的位置。</li>
<li>将DMAdView添加到父视图中。</li>
<li>最后，调用<code>loadAd</code>方法，开始请求广告。</li>
</ol>
<p>下面的代码片段，简要说明了这个过程：</p>
<pre><code>#import &quot;DMAdView.h&quot;

@interface DMBannerSampleViewController: UIViewController &lt;DMAdViewDelegate&gt;
{
    DMAdView *_dmAdView;
}
@end
</code></pre>

<pre><code>@implementation DMBannerSampleViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) 
    {
        self.title = NSLocalizedString(@&quot;Banner&quot;, @&quot;Banner&quot;);

        // 创建广告视图，此处使用的是测试ID，请登陆多盟官网（www.domob.cn）获取新的ID
        // Creat advertisement view please get your own ID from domob website
        _dmAdView = [[DMAdView alloc] initWithPublisherId:@&quot;56OJyGFYuMOI695Q87&quot;
                                              placementId:@&quot;16TLwMxaAc0izY7NJgmfgl5k&quot;];

        // 设置广告视图的位置宽与高均设置为0即可，该广告视图默认是横竖屏自适应，但需要在旋转时调用orientationChanged方法
        // Set the frame of advertisement view 
        _dmAdView.frame = CGRectMake(0, 20, FLEXIBLE_SIZE.width,FLEXIBLE_SIZE.height);
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    _dmAdView.delegate = self; // 设置 Delegate
    _dmAdView.rootViewController = self; // 设置 rootViewController
    [self.view addSubview:_dmAdView]; // 将广告视图添加到父视图中
    [_dmAdView loadAd]; // 开始加载广告
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    [_dmAdView removeFromSuperview]; // 将广告试图从父视图中移除
}

//针对Banner的横竖屏自适应方法
//method For multible orientation
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
                                duration:(NSTimeInterval)duration
{
    [_dmAdView orientationChanged];
}

- (void)dealloc
{
    _dmAdView.delegate = nil; 
    _dmAdView.rootViewController = nil;
    [_dmAdView release];
    [super dealloc];
}
@end
</code></pre>

<h6 id="dmadview">关于DMAdView的释放</h6>
<p>在这里强烈建议您，在释放DMAdView之前，将DMAdView的属性<code>delegat</code>和<code>rootViewController</code>设置为nil。如下例：</p>
<pre><code>- (void)dealloc
{
    _dmAdView.delegate = nil; 
    _dmAdView.rootViewController = nil;
    [_dmAdView release];
    [super dealloc];
}
</code></pre>

<h6 id="_3">设置可选参数</h6>
<p>还可以为<code>DMAdView</code>设置一些可选参数，来提高广告投放的精准性。这些参数的设置方法都定义在<code>DMAdview.h</code>中，如下：</p>
<pre><code>// 设置地理位置信息
- (void)setLocation:(CLLocation *)location;

// 设置邮编
- (void)setPostcode:(NSString *)postcode;

// 设置关键字
- (void)setKeywords:(NSString *)keywords;

// 设置用户年龄
- (void)setUserBirthday:(NSString *)userBirthday;

// 设置用户性别
- (void)setUserGender:(DMUserGenderType)userGender;
</code></pre>

<h6 id="dmadviewdelegate">实现DMAdViewDelegate</h6>
<p>您可以通过实现<code>DMAdViewDelegate</code>中定义的方法，来跟踪广告生命周期中的各个阶段。所有这些方法也都定义在<code>DMAdView.h</code>中，如下：</p>
<pre><code>@protocol DMAdViewDelegate &lt;NSObject&gt;
@optional

// 成功加载广告后，回调该方法
- (void)dmAdViewSuccessToLoadAd:(DMAdView *)adView;

// 加载广告失败后，回调该方法
- (void)dmAdViewFailToLoadAd:(DMAdView *)adView withError:(NSError *)error;

// 当将要呈现出 Modal View 时，回调该方法。如打开内置浏览器。
- (void)dmWillPresentModalViewFromAd:(DMAdView *)adView;

// 当呈现的 Modal View 被关闭后，回调该方法。如内置浏览器被关闭。
- (void)dmDidDismissModalViewFromAd:(DMAdView *)adView;

// 当因用户的操作（如点击下载类广告，需要跳转到Store），需要离开当前应用时，回调该方法
- (void)dmApplicationWillEnterBackgroundFromAd:(DMAdView *)adView;
@end
</code></pre>

<h2 id="_4">横幅广告的尺寸</h2>
<p>目前我们所支持的横幅广告尺寸包括</p>
<table>
<thead>
<tr>
<th>Size</th>
<th>Recommended</th>
</tr>
</thead>
<tbody>
<tr>
<td>320x50</td>
<td>iPhone/iPod Touch</td>
</tr>
<tr>
<td>300x250</td>
<td>iPhone/iPod Touch</td>
</tr>
<tr>
<td>488x80</td>
<td>iPad</td>
</tr>
<tr>
<td>728x90</td>
<td>iPad</td>
</tr>
<tr>
<td>600x500</td>
<td>iPad</td>
</tr>
<tr>
<td>Flexible</td>
<td>All iOS Devices</td>
</tr>
</tbody>
</table>
<p><strong>我们强烈建议您使用Flexible Banner</strong>，它可以适应各种类型的设备，以及进行横竖屏的自适应（Flexible Banner的高度在iPhone/iPod Touch上为<code>50</code>，在iPad上为<code>90</code>，宽度自适应）。上例中所展示的也是使用Flexible Banner的方法。</p>
<p>如果想使用固定尺寸的横幅广告，则可通过使用<code>DMAdView.h</code>中提供的其他宏定义来实现，如下：</p>
<pre><code>[_dmAdView setAdSize:DOMOB_AD_SIZE_320x50];
_dmAdView.frame = CGRectMake(0, 20, DOMOB_AD_SIZE_320x50.width,DOMOB_AD_SIZE_320x50.height);
</code></pre>

<p>展示的是使用<code>320x50</code>尺寸的横幅广告的方法。</p>
<h2 id="interstitial-ad">使用插屏广告（Interstitial Ad）</h2>
<p>插屏广告的使用，同样非常简单，只需要几步即可完成。</p>
<ol>
<li>导入<code>DMInterstitialAdController.h</code>头文件。</li>
<li>声明一个<code>DMInterstitialAdController</code>的实例。</li>
<li>让您的UIViewController实现<code>DMInterstitialAdControllerDelegate</code>协议。</li>
<li>在合适的位置初始化一个<code>DMInterstitialAdController</code>。</li>
<li>在合适的时候，调用<code>loadAd</code>方法，来预加载插屏广告。</li>
<li>在想要呈现插屏广告的时候，调用<code>present</code>方法，来呈现插屏广告。</li>
<li><code>注意</code>在呈现完成后，需要重新通过<code>loadAd</code>方法，加载一条新广告，用于下次呈现。</li>
</ol>
<p>下面的代码片段，简单描述了这个过程：</p>
<pre><code>@interface DMInterstitialSampleViewController: UIViewController &lt;DMInterstitialAd-ControllerDelegate&gt;
{
    DMInterstitialAdController *_dmInterstitial;
}
@end
</code></pre>

<pre><code>@implementation DMInterstitialSampleViewController
- (void)viewDidLoad
{
    [super viewDidLoad];

    //　初始化插屏广告，此处使用的是测试ID，请登陆多盟官网（www.domob.cn）获取新的ID 
    _dmInterstitial = [[DMInterstitialAdController alloc] initWithPublisherId:@“56OJyM1ouMGoULfJaL&quot;
                                                              placementId:@&quot;16TLwebvAchkAY6iOWkE6kpk&quot;
                                                       rootViewController:self];
    // 设置插屏广告的Delegate
    _dmInterstitial.delegate = self;
    // 加载一条插屏广告
    [_dmInterstitial loadAd];
}

- (void)viewDidUnload
{
    [super viewDidUnload];

    _dmInterstitial.delegate = nil; // 释放插屏广告对象前，请先将其delegate设置为nil
    [_dmInterstitial release]; // 释放插屏广告对象
} 

- (void)onPresentBtnClicked:(id)sender
{
    // 在需要呈现插屏广告前，先通过isReady方法检查广告是否就绪
    if (_dmInterstitial.isReady)
    {
        [_dmInterstitial present]; // 呈现插屏广告
    }
    else
    {
        // 如果还没有ready，可以再调用loadAd
        [_dmInterstitial loadAd];
    }
}

// 当插屏广告被关闭后，回调该方法
- (void)dmInterstitialDidDismissScreen:(DMInterstitialAdController *)dmInterstitial
{
    // 插屏广告关闭后，加载一条新广告用于下次呈现
    [_dmInterstitial loadAd];
}
@end
</code></pre>

<h6 id="dminterstitialadcontroller">关于DMInterstitialAdController的释放</h6>
<p>在这里强烈建议您，在释放<code>DMInterstitialAdController</code>之前，将其delegate属性设置为nil。如：</p>
<pre><code>- (void)viewDidUnload
{
    [super viewDidUnload];

    _dmInterstitial.delegate = nil; // 释放插屏广告对象前，请先将其delegate设置为nil
    [_dmInterstitial release]; // 释放插屏广告对象
} 
</code></pre>

<h6 id="_5">设置可选参数</h6>
<p>与DMAdView相同，也可以为<code>DMInterstitialAdController</code>设置一些可选参数，来提高广告投放的精准性。这些参数的设置方法都定义在<code>DMInterstitialAdController.h</code>中，如下：</p>
<pre><code>// 设置地理位置信息
- (void)setLocation:(CLLocation *)location;

// 设置邮编
- (void)setPostcode:(NSString *)postcode;

// 设置关键字
- (void)setKeywords:(NSString *)keywords;

// 设置用户年龄
- (void)setUserBirthday:(NSString *)userBirthday;

// 设置用户性别
- (void)setUserGender:(DMUserGenderType)userGender;
</code></pre>

<h6 id="dminterstitialadcontrollerdelegate">实现DMInterstitialAdControllerDelegate</h6>
<p>您可以通过实现<code>DMInterstitialAdControllerDelegate</code>中定义的方法，来跟踪广告生命周期中的各个阶段。所有这些方法也都定义在<code>DMInterstitialAdController.h</code>中，如下：</p>
<pre><code>@protocol DMInterstitialAdControllerDelegate &lt;DMAdViewDelegate&gt;
@optional

// 当插屏广告被成功加载后，回调该方法
- (void)dmInterstitialSuccessToLoadAd:(DMInterstitialAdController *)dmInterstitial;

// 当插屏广告加载失败后，回调该方法
- (void)dmInterstitialFailToLoadAd:(DMInterstitialAdController *)dmInterstitial withError:(NSError *)err;

// 当插屏广告要被呈现出来前，回调该方法
- (void)dmInterstitialWillPresentScreen:(DMInterstitialAdController *)dmInterstitial;

// 当插屏广告被关闭后，回调该方法
- (void)dmInterstitialDidDismissScreen:(DMInterstitialAdController *)dmInterstitial;

// 当将要呈现出 Modal View 时，回调该方法。如打开内置浏览器。
- (void)dmInterstitialWillPresentModalView:(DMInterstitialAdController *)dmInterstitial;

// 当呈现的 Modal View 被关闭后，回调该方法。如内置浏览器被关闭。
- (void)dmInterstitialDidDismissModalView:(DMInterstitialAdController *)dmInterstitial;

// 当因用户的操作（如点击下载类广告，需要跳转到Store），需要离开当前应用时，回调该方法
- (void)dmInterstitialApplicationWillEnterBackground:(DMInterstitialAdController *)dmInterstitial;
@end
</code></pre>

<h2 id="feeds-ad">使用信息流广告（Feeds Ad）</h2>
<p>信息流广告的使用，需要以下几步：</p>
<ol>
<li>导入<code>DMFeedsAdView.h</code>头文件。</li>
<li>声明一个<code>DMFeedsAdView</code>的实例。</li>
<li>让您的UIViewController实现<code>DMFeedsAdViewDelegate</code>协议。</li>
<li>在您的Controller的m文件中，使用Publisher ID和Placement ID以及负责呈现信息流广告的起始坐标<code>origin</code>来初始化一个<code>DMFeedsAdView</code>，同时传递当前<code>Controller</code>，设置代理。</li>
<li>在合适的时候，调用<code>loadAd</code>方法，来预加载信息流广告。</li>
<li>在想要呈现信息流广告的时候，调用<code>present</code>方法，来呈现信息流广告。</li>
<li>在呈现完成后，需要重新通过<code>loadAd</code>方法加载一条新广告，用于下次呈现。</li>
<li><code>注意</code>信息流只支持<code>竖屏</code>的展示，如果当前界面支持横屏 请做如下操作以防止界面混乱。<ul>
<li>广告在播放时，如果由竖屏转为横屏，请调用<code>closeAd</code>关闭广告。</li>
<li>如果在横屏状态下拉界面，请<code>阻止广告展现</code>。</li>
</ul>
</li>
</ol>
<p>下面的代码片段，简单描述了这个过程：</p>
<pre><code>#import &quot;DMFeedsAdView.h&quot;

@interface DMFeedsAdViewController : UIViewController&lt;DMFeedsAdViewDelegate&gt;

@property (nonatomic, retain) DMFeedsAdView *feedsView;

@end
</code></pre>

<pre><code>@implementation DMFeedsAdViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

   //注意区分系统获取不同的起始点坐标
    origin = CGPointMake(0, 0);
    if (!([[[UIDevice currentDevice] systemVersion] floatValue] &lt; 7.0)) {
        origin = CGPointMake(0, 20);
        // do not forget if there is a statusBar down 20 pixels height in iOS 7.
        self.myTable.frame = CGRectMake(origin.x,
                                        origin.y,
                                        self.view.frame.size.width,
                                        self.view.frame.size.height);
    }
    //初始化Feeds Ad View

     /**feeds ad view start **/

    _feedsView = [[DMFeedsAdView alloc]initWithPublisherId:DMPUBLISHERID
                                               placementId:DMPLCAEMENTID_FEEDS
                                                    origin:origin];

    _feedsView.rootViewController = self;
    _feedsView.delegate = self;

    [_feedsView loadAd];

    /**feeds ad view end **/

    //以下代码是tableView的刷新代码 和 Feeds Ad View 无关
    /** refresh view  **/
    if (_refreshHeaderView == nil) {

        EGORefreshTableHeaderView *view = [[EGORefreshTableHeaderView alloc]
                                           initWithFrame:CGRectMake(0.0f,0.0f - _feedsView.frame.size.height,
                                                                                  self.view.frame.size.width,
                                                                                _feedsView.frame.size.height)];
        view.delegate = self;
        [self.myTable addSubview:view];
        _refreshHeaderView = view;
        [view release];

    }

    //  refresh view update the last update date
    [_refreshHeaderView refreshLastUpdatedDate];

}
//tableView的刷新方法 在这里判断如果是竖屏 展示广告
- (void)reloadTableViewDataSource{

    //  should be calling your tableviews data source model to reload
    //  put here just for demo
    _reloading = YES;

    /** 竖屏情况开始展现广告
     present feeds ad view
     please choose the orientation you support
     UIDeviceOrientationPortrait/UIDeviceOrientationPortraitUpsideDown   **/

    if ([[UIApplication sharedApplication] statusBarOrientation]
                                          == UIInterfaceOrientationPortrait)
    {
        [_feedsView present];
    }


}
//鉴于显示广告时程序界面依然可操作，所以我们提供了关闭Feeds ad view的方法closeAd.需要开发者在出现视图切换时手动关闭广告。（例：用户点击cell进入下一个界面）
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // close the ad view by yourself
    [_feedsView closeAd];
}


#pragma mark 
#pragma mark FeedsAdViewDelegate
- (void)dmFeedsSuccessToLoadAd:(DMFeedsAdView *)dmFeeds
{
    NSLog(@&quot; [Domob FeedsAdView] SuccessToLoadAd&quot;);
}
- (void)dmFeedsFailToLoadAd:(DMFeedsAdView *)dmFeeds withError:(NSError *)err
{
     NSLog(@&quot; [Domob FeedsAdView] FailToLoadAd&quot;);
}
- (void)dmFeedsDidClicked:(DMFeedsAdView *)dmFeeds
{
     NSLog(@&quot; [Domob FeedsAdView] DidClicked&quot;);
}

// Feeds广告生命周期的回调
- (void)dmFeedsWillPresentScreen:(DMFeedsAdView *)dmFeeds
{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:.3];
    [self.myTable setFrame:CGRectMake(origin.x,
                                      self.feedsView.frame.size.height+origin.y,
                                      self.myTable.frame.size.width,
                                      self.myTable.frame.size.height)];
    [UIView commitAnimations];

}
//我们建议在视图消失时实现加载下一条广告
- (void)dmFeedsDidDismissScreen:(DMFeedsAdView *)dmFeeds
{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:.3];
    [self.myTable setFrame:CGRectMake(origin.x,
                                      origin.y,
                                      self.myTable.frame.size.width,
                                      self.myTable.frame.size.height)];
    [UIView commitAnimations];
    //load ad when the ad view dismiss
    [_feedsView loadAd];
}

// 由于用户对广告的操作引发的事件回调
- (void)dmFeedsWillPresentModalView:(DMFeedsAdView *)dmFeeds
{
     NSLog(@&quot; [Domob FeedsAdView] WillPresentModalView&quot;);
}
- (void)dmFeedsDidDismissModalView:(DMFeedsAdView *)dmFeeds
{
     NSLog(@&quot; [Domob FeedsAdView] DidDismissModalView&quot;);
}
- (void)dmFeedsApplicationWillEnterBackground:(DMFeedsAdView *)dmFeeds
{
     NSLog(@&quot; [Domob FeedsAdView] WillEnterBackground&quot;);
}


</code></pre>

<h6 id="dmfeedsadview">关于DMFeedsAdView的释放</h6>
<p>在这里强烈建议您，在释放DMFeedsAdView之前，将其delegate属性设置为nil。</p>
<h6 id="_6">设置可选参数</h6>
<p>可以为<code>DMFeedsAdView</code>设置一些可选参数，来提高广告投放的精准性。这些参数的设置方法都定义在<code>DMFeedsAdView.h</code>中，如下：</p>
<pre><code>// 设置地理位置信息
- (void)setLocation:(CLLocation *)location;

// 设置邮编
- (void)setPostcode:(NSString *)postcode;

// 设置关键字
- (void)setKeywords:(NSString *)keywords;

// 设置用户年龄
- (void)setUserBirthday:(NSString *)userBirthday;

// 设置用户性别
- (void)setUserGender:(DMUserGenderType)userGender;
</code></pre>

<h6 id="dmfeedsadviewdelegate">实现DMFeedsAdViewDelegate</h6>
<p>您可以通过实现<code>DMFeedsAdViewDelegate</code>中定义的方法，来跟踪广告生命周期中的各个阶段。所有这些方法也都定义在<code>DMFeedsAdView.h</code>中，如下：</p>
<pre><code>@protocol DMFeedsAdViewDelegate

@optional
// Sent when an ad request success to load an ad
- (void)dmFeedsSuccessToLoadAd:(DMFeedsAdView *)dmFeeds;
// Sent when an ad request fail to load an ad
- (void)dmFeedsFailToLoadAd:(DMFeedsAdView *)dmFeeds withError:(NSError *)err;
// Sent when the feeds ad is clicked
- (void)dmFeedsDidClicked:(DMFeedsAdView *)dmFeeds;

// Sent just before presenting the user a modal view
- (void)dmFeedsWillPresentModalView:(DMFeedsAdView *)dmFeeds;
// Sent just after dismissing the modal view
- (void)dmFeedsDidDismissModalView:(DMFeedsAdView *)dmFeeds;
// Sent just before the application will background or terminate because the user's action
// (Such as the user clicked on an ad that will launch App Store).
- (void)dmFeedsApplicationWillEnterBackground:(DMFeedsAdView *)dmFeeds;

// Sent just before presenting an feeds ad view
- (void)dmFeedsWillPresentScreen:(DMFeedsAdView *)dmFeeds;
// Sent just after dismissing a feeds ad view
- (void)dmFeedsDidDismissScreen:(DMFeedsAdView *)dmFeeds;

@end
</code></pre>

<h2 id="splash-ad">使用开屏广告（Splash Ad）</h2>
<p>开屏广告的使用场景是在App刚刚开启时，在SDK内分为<code>缓存开屏</code>和<code>实时开屏</code>两种。</p>
<p>缓存开屏的加载机制为，本次加载，缓存本次的广告应答以及相关资源，下次开启时展现。</p>
<p>实时开屏在每次开启时都会实时请求广告并加载和缓存资源，在超时时间前加载完成即自动展现。</p>
<p>详细使用方法可见Sample中的App委派类的<code>application:didFinishLaunchingWithOptions:</code>方法中使用的示例代码。</p>
<table>
<thead>
<tr>
<th>开屏广告类型</th>
<th>广告请求流程</th>
<th>优点</th>
<th>缺点</th>
</tr>
</thead>
<tbody>
<tr>
<td>缓存开屏</td>
<td>当次缓存，下次展现。</td>
<td>无需等待广告loading,体验好。</td>
<td>填充到展现流失率较高。</td>
</tr>
<tr>
<td>实时开屏</td>
<td>当次加载，当次展现，超时放弃（超时时限开发者可设）。</td>
<td>填充到展现流失率较低。</td>
<td>用户需要短暂的等待。</td>
</tr>
</tbody>
</table>
<p>下面的代码片段，简单描述了这个过程：</p>
<pre><code>#import &quot;DMSplashAdController.h&quot;
#import &quot;DMRTSplashAdController.h&quot;

@interface DMAppDelegate : UIResponder &lt;UIApplicationDelegate, DMSplashAdControllerDelegate&gt;

@property (retain, nonatomic) UIWindow *window;
@property (retain, nonatomic) ViewController *firstViewController;
@property (retain, nonatomic) DMSplashAdController *splashAd;
@property (retain, nonatomic) DMRTSplashAdController *rtSplashAd;

@end

</code></pre>

<pre><code>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{ 
    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];

    self.firstViewController = [[[ViewController alloc] init] autorelease];

    self.window.rootViewController = self.firstViewController;
    [self.window makeKeyAndVisible];

    //开发者自主选择实时开屏或者缓存开屏
    BOOL isRealTimeSplash = NO;

    //呈现实时开屏广告
    if (isRealTimeSplash) {
        _rtSplashAd =[[DMRTSplashAdController alloc]initWithPublisherId:DOMOB_PUBLISHERID
                                                            placementId:DOMOB_RTSPLASHPLACEMENTID
                                                                   size:CGSizeMake(0, 0)
                                                                 offset:0
                                                                 window:self.window
                                                             background:[UIColor colorWithPatternImage:[UIImage imageNamed:@&quot;Default.png&quot;]]
                                                              animation:YES];


        _rtSplashAd.delegate = self;
        [_rtSplashAd present];


    }else{
        // 呈现缓存开屏广告
        _splashAd = [[DMSplashAdController alloc]initWithPublisherId:DOMOB_PUBLISHERID                                                                                placementId:DOMOB_SPLASHPLACEMENTID
                                                                size:CGSizeMake(0, 0)
                                                              offset:0
                                                              window:self.window
                                                          background:[UIColor colorWithPatternImage:[UIImage imageNamed:@&quot;Default.png&quot;]]
                                                           animation:YES];

        _splashAd.delegate = self;
        if (_splashAd.isReady)
        {
            [_splashAd present];
        }

    }


    return YES;
}

</code></pre>

<h6 id="_7">设置可选参数</h6>
<p>与其他广告形式相同，也可以为<code>DMSplashAdController</code>设置一些可选参数，来提高广告投放的精准性。这些参数的设置方法都定义在<code>DMSplashAdController.h</code>中，如下：</p>
<pre><code>// 设置地理位置信息
- (void)setLocation:(CLLocation *)location;

// 设置邮编
- (void)setPostcode:(NSString *)postcode;

// 设置关键字
- (void)setKeywords:(NSString *)keywords;

// 设置用户年龄
- (void)setUserBirthday:(NSString *)userBirthday;

// 设置用户性别
- (void)setUserGender:(DMUserGenderType)userGender;
</code></pre>

<h6 id="dmsplashadcontrollerdelegate">实现DMSplashAdControllerDelegate</h6>
<p>您可以通过实现<code>DMSplashAdControllerDelegate</code>中定义的方法，来跟踪广告生命周期中的各个阶段。所有这些方法也都定义在<code>DMSplashAdController.h</code>中，如下：</p>
<pre><code>@protocol DMSplashAdControllerDelegate
@optional
// 当开屏广告加载成功后，回调该方法
- (void)dmSplashAdSuccessToLoadAd:(DMSplashAdController *)dmSplashAd;
// 当开屏广告加载失败后，回调该方法
- (void)dmSplashAdFailToLoadAd:(DMSplashAdController *)dmSplashAd withError:(NSError *)err;

// 当插屏广告要被呈现出来前，回调该方法
- (void)dmSplashAdWillPresentScreen:(DMSplashAdController *)dmSplashAd;
// 当插屏广告被关闭后，回调该方法
- (void)dmSplashAdDidDismissScreen:(DMSplashAdController *)dmSplashAd;
@end
</code></pre>

<h2 id="_8">获取示例</h2>
<p>我们的实例工程都托管在Github上</p>
<ul>
<li><a href="https://github.com/Domob-SDK/domob-ios-ad-sdk-sample">iOS Ad SDK 示例工程</a> 其中包括上述所有广告形式的使用方法。</li>
<li><a href="https://github.com/Domob-SDK/domob-ios-ad-sdk-cocos2dx-sample">iOS Ad SDK Cocos-2dx 示例工程</a></li>
<li><a href="https://github.com/Domob-SDK/domob-ios-ad-sdk-unity-plugin">iOS Ad SDK Unity3D 插件工程</a></li>
</ul>
<h2 id="_9">获得帮助</h2>
<p>如还有疑问，欢迎随时发邮件到support@domob.cn获得更多帮助。</p>
</div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>© 2014 Domob</p>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/prettify-1.0.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
    </body>
</html>